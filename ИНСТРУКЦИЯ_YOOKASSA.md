# Инструкция по настройке YooKassa

## Быстрая настройка

### 1. Получение данных из личного кабинета

1. Откройте личный кабинет YooKassa: https://yookassa.ru/my/i/aSR_d_SeRsnM/l
2. Перейдите в раздел **"Настройки"** → **"API"**
3. Найдите раздел **"Тестовые данные"** (для тестирования) или **"Боевые данные"** (для продакшена)
4. Скопируйте:
   - **Shop ID** (идентификатор магазина)
   - **Secret Key** (секретный ключ)

### 2. Установка библиотеки

```bash
pip install yookassa
```

### 3. Настройка .env файла

Откройте файл `.env` в корне проекта и добавьте/обновите следующие строки:

```env
# Выбор платежной системы
PAYMENT_PROVIDER=yookassa

# YooKassa настройки (замените на ваши данные)
YOOKASSA_SHOP_ID=ваш_shop_id_здесь
YOOKASSA_SECRET_KEY=ваш_secret_key_здесь
YOOKASSA_RETURN_URL=https://t.me/StartNowQ_bot

# Валюта платежей
PAYMENT_CURRENCY=RUB
```

**Важно:**
- Замените `ваш_shop_id_здесь` на реальный Shop ID
- Замените `ваш_secret_key_здесь` на реальный Secret Key
- Не коммитьте файл `.env` в Git (он уже в .gitignore)

### 4. Перезапуск бота

После настройки перезапустите бота:

```bash
python -m bots.sales_bot
```

## Тестирование

Для тестирования используйте:
- **Тестовые данные** из личного кабинета YooKassa
- **Тестовые карты**: https://yookassa.ru/developers/payment-acceptance/testing-and-going-live/testing

Пример тестовых карт:
- Успешная оплата: `5555 5555 5555 4444`
- Отклоненная оплата: `5555 5555 5555 4477`

## Проверка работы

1. Откройте бота: `t.me/StartNowQ_bot`
2. Отправьте `/start`
3. Выберите тариф
4. Нажмите "Оплатить"
5. Должна открыться страница оплаты YooKassa

## Возврат к mock оплате

Если нужно вернуться к тестовой mock оплате:

```env
PAYMENT_PROVIDER=mock
```

## Проблемы и решения

### Бот не переключается на YooKassa

1. Проверьте, что `PAYMENT_PROVIDER=yookassa` в `.env`
2. Проверьте, что библиотека установлена: `pip show yookassa`
3. Проверьте логи бота на наличие ошибок

### Ошибка "YooKassa credentials not configured"

1. Убедитесь, что `YOOKASSA_SHOP_ID` и `YOOKASSA_SECRET_KEY` заполнены в `.env`
2. Проверьте, что нет лишних пробелов в значениях
3. Перезапустите бота

### Ошибка при создании платежа

1. Проверьте правильность Shop ID и Secret Key
2. Убедитесь, что используете правильные данные (тестовые или боевые)
3. Проверьте логи бота для деталей ошибки

## Дополнительная информация

- Документация YooKassa: https://yookassa.ru/developers/
- API документация: https://yookassa.ru/developers/api
- Поддержка: https://yookassa.ru/support/

